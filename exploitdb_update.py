from db import mongo_connect
from exploitdb import ExploitDB
from argparse import ArgumentParser

parser = ArgumentParser()
parser.add_argument('--mode', type=str, default='download', help='download exploitdb into local', choices=['download', 'insert'])

if __name__ == "__main__":
    mongo_connect()
    args = parser.parse_args()
    if args.mode == 'download':
        ExploitDB().load()
    elif args.mode == 'insert':
        for vulnerability in ExploitDB().new():
            vulnerability.save()