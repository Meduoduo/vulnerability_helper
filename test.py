from typing import Dict, List
from db import mongo_connect
from model import Vulnerability
from config import SEARCH_KEY
from kasumi import *

def search():
    vulns = Vulnerability.find_by_description('dirty pipe')
    return [KasumiSearchResult.load_from_dict({
        'description': vuln.description,
        'codes': vuln.codes,
        'exp': vuln.exp,
        'poc': vuln.poc,
        'result': 'result has been set'
    }, disabled_llm_columns=['exp', 'poc'], disabled_show_columns=['description', 'codes', 'result']) for vuln in vulns]

search_desc = "search vulnerability by columns, accept one of [code,name,platform,description] as column name. you had better use english instead of others"\
                     "example:{'code':'CVE-2016-10033'} or {'name':'EternalBlue'} or {'platform':'linux'} or {'description':'dirty pipe'}"

if __name__ == "__main__":
    mongo_connect()

    print(search())